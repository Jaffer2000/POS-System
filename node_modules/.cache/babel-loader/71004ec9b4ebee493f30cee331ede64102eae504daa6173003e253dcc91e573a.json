{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"header-content\"\n};\nconst _hoisted_2 = {\n  class: \"search-bar\"\n};\nconst _hoisted_3 = {\n  class: \"user-info\"\n};\nconst _hoisted_4 = {\n  class: \"user-signoff\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"popup-overlay\"\n};\nconst _hoisted_6 = {\n  class: \"popup-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"header\", null, [_createElementVNode(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"span\", {\n    class: \"header-title\"\n  }, \"Point of Sale\", -1)), _createElementVNode(\"div\", _hoisted_2, [_cache[4] || (_cache[4] = _createElementVNode(\"i\", {\n    class: \"fas fa-magnifying-glass search-icon\"\n  }, null, -1)), _withDirectives(_createElementVNode(\"input\", {\n    ref: \"searchInput\",\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.barcodeInput = $event),\n    onInput: _cache[1] || (_cache[1] = (...args) => $data.debouncedOnBarcodeInput && $data.debouncedOnBarcodeInput(...args)),\n    id: \"barcodeInput\",\n    placeholder: \"Zoek Product op Naam, Barcode, Product id\"\n  }, null, 544), [[_vModelText, $data.barcodeInput]]), _cache[5] || (_cache[5] = _createElementVNode(\"i\", {\n    class: \"fas fa-barcode barcode-icon\"\n  }, null, -1))]), _createElementVNode(\"div\", _hoisted_3, [_cache[6] || (_cache[6] = _createElementVNode(\"i\", {\n    class: \"fas fa-user user-image\"\n  }, null, -1)), _createElementVNode(\"span\", null, _toDisplayString($props.user ? `${$props.user.firstName} ${$props.user.lastName}` : \"John Doe\"), 1)]), _createElementVNode(\"div\", _hoisted_4, [_cache[7] || (_cache[7] = _createElementVNode(\"i\", {\n    class: \"fas fa-right-from-bracket user-signofficon\"\n  }, null, -1)), _createElementVNode(\"span\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.handleLogout && $options.handleLogout(...args))\n  }, \"Afmelden\")])]), $data.showPopup ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"p\", null, _toDisplayString(this.translations.barcodeNotFound), 1), _createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.closePopup && $options.closePopup(...args))\n  }, \"Sluiten\")])])) : _createCommentVNode(\"\", true)]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_createElementVNode","_hoisted_1","_hoisted_2","ref","type","_cache","$event","$data","barcodeInput","onInput","args","debouncedOnBarcodeInput","id","placeholder","_hoisted_3","_toDisplayString","$props","user","firstName","lastName","_hoisted_4","onClick","$options","handleLogout","showPopup","_hoisted_5","_hoisted_6","translations","barcodeNotFound","closePopup","_createCommentVNode"],"sources":["C:\\wamp64\\www\\tbpos\\src\\front\\src\\components\\HeaderComponent.vue"],"sourcesContent":["<template>\r\n  <header>\r\n    <div class=\"header-content\">\r\n      <span class=\"header-title\">Point of Sale</span>\r\n      <div class=\"search-bar\">\r\n        <i class=\"fas fa-magnifying-glass search-icon\"></i>\r\n        <input\r\n          ref=\"searchInput\"\r\n          type=\"text\"\r\n          v-model=\"barcodeInput\"\r\n          @input=\"debouncedOnBarcodeInput\"\r\n          id=\"barcodeInput\"\r\n          placeholder=\"Zoek Product op Naam, Barcode, Product id\"\r\n        />\r\n        <i class=\"fas fa-barcode barcode-icon\"></i>\r\n      </div>\r\n\r\n      <div class=\"user-info\">\r\n        <i class=\"fas fa-user user-image\"></i>\r\n        <span>{{\r\n          user ? `${user.firstName} ${user.lastName}` : \"John Doe\"\r\n        }}</span>\r\n      </div>\r\n\r\n      <div class=\"user-signoff\">\r\n        <i class=\"fas fa-right-from-bracket user-signofficon\"></i>\r\n        <span @click=\"handleLogout\">Afmelden</span>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Popup for unknown barcode -->\r\n    <div v-if=\"showPopup\" class=\"popup-overlay\">\r\n      <div class=\"popup-message\">\r\n        <p>{{ this.translations.barcodeNotFound }}</p>\r\n        <button @click=\"closePopup\">Sluiten</button>\r\n      </div>\r\n    </div>\r\n  </header>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"HeaderComponent\",\r\n  props: {\r\n    apiBaseUrl: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    translations: {\r\n      type: Object,\r\n      required: true,\r\n    },\r\n    disableFocus: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    token: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n    user: {\r\n      type: Object,\r\n      default: () => null, // Default to null if no user is provided\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      barcodeInput: \"\",\r\n      showPopup: false,\r\n      debouncedOnBarcodeInput: null,\r\n      focusInterval: null,\r\n    };\r\n  },\r\n  watch: {\r\n    disableFocus(newValue) {\r\n      if (newValue) {\r\n        clearInterval(this.focusInterval); // Stop focusing\r\n      } else {\r\n        this.focusInterval = setInterval(this.maintainFocus, 100); // Resume focusing\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    debounce(func, wait) {\r\n      let timeout;\r\n      return function (...args) {\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(() => func.apply(this, args), wait);\r\n      };\r\n    },\r\n    async fetchProduct(term, type = \"BARCODE\") {\r\n      try {\r\n        const response = await axios.post(\r\n          `${this.apiBaseUrl}/products/find`,\r\n          {\r\n            type,\r\n            term,\r\n          },\r\n          {\r\n            headers: {\r\n              Authorization: `Bearer ${this.token}`,\r\n            },\r\n          }\r\n        );\r\n\r\n        const jsend = response.data;\r\n\r\n        if (jsend.status === \"success\" && jsend.data.length > 0) {\r\n          return jsend.data; // Return the list of products\r\n        } else {\r\n          return null; // No products found\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching product:\", error);\r\n        this.showPopup = true; // Show popup for fetch error\r\n        return null; // Return null if an error occurs\r\n      }\r\n    },\r\n    async onBarcodeInput() {\r\n      const term = this.barcodeInput.trim();\r\n      if (!term) return;\r\n\r\n      this.showPopup = false; // Hide any existing popups\r\n\r\n      // Determine the type of input\r\n      let type;\r\n      if (/^\\d+$/.test(term)) {\r\n        type = term.length === 12 || term.length === 13 ? \"BARCODE\" : \"ALL\";\r\n      } else if (term.match(/^[a-zA-Z0-9-]+$/)) {\r\n        type = \"REFERENCE\";\r\n      } else {\r\n        type = \"NAME\";\r\n      }\r\n\r\n      // Fetch product based on detected type\r\n      const products = await this.fetchProduct(term, type);\r\n\r\n      if (products && products.length > 0) {\r\n        const product = products[0]; // Handle multiple products (select first for now)\r\n        this.$emit(\"product-scanned\", product);\r\n        this.barcodeInput = \"\"; // Clear input\r\n      } else {\r\n        this.showPopup = true; // Show popup if no product found\r\n      }\r\n    },\r\n    closePopup() {\r\n      this.showPopup = false;\r\n      this.barcodeInput = \"\";\r\n    },\r\n    maintainFocus() {\r\n      if (!this.disableFocus) {\r\n        this.$refs.searchInput.focus();\r\n      }\r\n    },\r\n    handleLogout() {\r\n      this.$emit(\"logout\"); // Emit the logout event to App.vue\r\n    },\r\n  },\r\n  mounted() {\r\n    this.focusInterval = setInterval(this.maintainFocus, 100);\r\n    this.debouncedOnBarcodeInput = this.debounce(this.onBarcodeInput, 50);\r\n  },\r\n  beforeUnmount() {\r\n    clearInterval(this.focusInterval);\r\n  },\r\n};\r\n</script>\r\n"],"mappings":";;EAESA,KAAK,EAAC;AAAgB;;EAEpBA,KAAK,EAAC;AAAY;;EAalBA,KAAK,EAAC;AAAW;;EAOjBA,KAAK,EAAC;AAAc;;EAxB/BC,GAAA;EA+B0BD,KAAK,EAAC;;;EACrBA,KAAK,EAAC;AAAe;;uBA/B9BE,mBAAA,CAoCS,iBAnCPC,mBAAA,CA0BM,OA1BNC,UA0BM,G,0BAzBJD,mBAAA,CAA+C;IAAzCH,KAAK,EAAC;EAAc,GAAC,eAAa,QACxCG,mBAAA,CAWM,OAXNE,UAWM,G,0BAVJF,mBAAA,CAAmD;IAAhDH,KAAK,EAAC;EAAqC,e,gBAC9CG,mBAAA,CAOE;IANAG,GAAG,EAAC,aAAa;IACjBC,IAAI,EAAC,MAAM;IARrB,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IASmBC,KAAA,CAAAC,YAAY,GAAAF,MAAA;IACpBG,OAAK,EAAAJ,MAAA,QAAAA,MAAA,UAAAK,IAAA,KAAEH,KAAA,CAAAI,uBAAA,IAAAJ,KAAA,CAAAI,uBAAA,IAAAD,IAAA,CAAuB;IAC/BE,EAAE,EAAC,cAAc;IACjBC,WAAW,EAAC;gCAHHN,KAAA,CAAAC,YAAY,E,6BAKvBR,mBAAA,CAA2C;IAAxCH,KAAK,EAAC;EAA6B,c,GAGxCG,mBAAA,CAKM,OALNc,UAKM,G,0BAJJd,mBAAA,CAAsC;IAAnCH,KAAK,EAAC;EAAwB,eACjCG,mBAAA,CAES,cAAAe,gBAAA,CADPC,MAAA,CAAAC,IAAI,MAAMD,MAAA,CAAAC,IAAI,CAACC,SAAS,IAAIF,MAAA,CAAAC,IAAI,CAACE,QAAQ,qB,GAI7CnB,mBAAA,CAGM,OAHNoB,UAGM,G,0BAFJpB,mBAAA,CAA0D;IAAvDH,KAAK,EAAC;EAA4C,eACrDG,mBAAA,CAA2C;IAApCqB,OAAK,EAAAhB,MAAA,QAAAA,MAAA,UAAAK,IAAA,KAAEY,QAAA,CAAAC,YAAA,IAAAD,QAAA,CAAAC,YAAA,IAAAb,IAAA,CAAY;KAAE,UAAQ,E,KAK7BH,KAAA,CAAAiB,SAAS,I,cAApBzB,mBAAA,CAKM,OALN0B,UAKM,GAJJzB,mBAAA,CAGM,OAHN0B,UAGM,GAFJ1B,mBAAA,CAA8C,WAAAe,gBAAA,MAAnCY,YAAY,CAACC,eAAe,OACvC5B,mBAAA,CAA4C;IAAnCqB,OAAK,EAAAhB,MAAA,QAAAA,MAAA,UAAAK,IAAA,KAAEY,QAAA,CAAAO,UAAA,IAAAP,QAAA,CAAAO,UAAA,IAAAnB,IAAA,CAAU;KAAE,SAAO,E,OAlC3CoB,mBAAA,W","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}